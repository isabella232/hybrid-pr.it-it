---
title: Configurare la connettività di cloud ibrido in Azure e nell'hub di Azure Stack
description: Informazioni su come configurare la connettività di cloud ibrido usando Azure e l'hub di Azure Stack.
author: BryanLa
ms.topic: article
ms.date: 11/05/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 11/05/2019
ms.openlocfilehash: 16c5d7820e8c865a9f88cb00da5cc7c854379414
ms.sourcegitcommit: d2def847937178f68177507be151df2aa8e25d53
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 07/20/2020
ms.locfileid: "86477287"
---
# <a name="configure-hybrid-cloud-connectivity-using-azure-and-azure-stack-hub"></a><span data-ttu-id="49ccb-103">Configurare la connettività di cloud ibrido usando Azure e l'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-103">Configure hybrid cloud connectivity using Azure and Azure Stack Hub</span></span>

<span data-ttu-id="49ccb-104">È possibile accedere alle risorse con sicurezza in Azure globale e nell'hub di Azure Stack usando il modello di connettività ibrida.</span><span class="sxs-lookup"><span data-stu-id="49ccb-104">You can access resources with security in global Azure and Azure Stack Hub using the hybrid connectivity pattern.</span></span>

<span data-ttu-id="49ccb-105">In questa soluzione si compilerà un ambiente di esempio per:</span><span class="sxs-lookup"><span data-stu-id="49ccb-105">In this solution, you'll build a sample environment to:</span></span>

> [!div class="checklist"]
> - <span data-ttu-id="49ccb-106">Mantenere i dati in locale per soddisfare i requisiti normativi o relativi alla privacy, mantenendo comunque l'accesso alle risorse globali di Azure.</span><span class="sxs-lookup"><span data-stu-id="49ccb-106">Keep data on-premises to meet privacy or regulatory requirements but keep access to global Azure resources.</span></span>
> - <span data-ttu-id="49ccb-107">Gestire un sistema legacy usando funzioni di distribuzione di app e risorse a livello di cloud in Azure globale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-107">Maintain a legacy system while using cloud-scaled app deployment and resources in global Azure.</span></span>

> [!Tip]  
> <span data-ttu-id="49ccb-108">![hybrid-pillars.png](./media/solution-deployment-guide-cross-cloud-scaling/hybrid-pillars.png)</span><span class="sxs-lookup"><span data-stu-id="49ccb-108">![hybrid-pillars.png](./media/solution-deployment-guide-cross-cloud-scaling/hybrid-pillars.png)</span></span>  
> <span data-ttu-id="49ccb-109">L'hub di Microsoft Azure Stack è un'estensione di Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-109">Microsoft Azure Stack Hub is an extension of Azure.</span></span> <span data-ttu-id="49ccb-110">che offre all'ambiente locale l'agilità e l'innovazione del cloud computing, abilitando l'unico cloud ibrido che consente di creare e distribuire ovunque app ibride.</span><span class="sxs-lookup"><span data-stu-id="49ccb-110">Azure Stack Hub brings the agility and innovation of cloud computing to your on-premises environment, enabling the only hybrid cloud that allows you to build and deploy hybrid apps anywhere.</span></span>  
> 
> <span data-ttu-id="49ccb-111">L'articolo [Considerazioni per la progettazione di app ibride](overview-app-design-considerations.md) esamina i concetti fondamentali di qualità del software (posizionamento, scalabilità, disponibilità, resilienza, gestibilità e sicurezza) per la progettazione, la distribuzione e la gestione di app ibride.</span><span class="sxs-lookup"><span data-stu-id="49ccb-111">The article [Hybrid app design considerations](overview-app-design-considerations.md) reviews pillars of software quality (placement, scalability, availability, resiliency, manageability, and security) for designing, deploying, and operating hybrid apps.</span></span> <span data-ttu-id="49ccb-112">Le considerazioni di progettazione consentono di ottimizzare la progettazione delle app ibride, riducendo al minimo i rischi negli ambienti di produzione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-112">The design considerations assist in optimizing hybrid app design, minimizing challenges in production environments.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="49ccb-113">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="49ccb-113">Prerequisites</span></span>

<span data-ttu-id="49ccb-114">Per creare una distribuzione di connettività ibrida sono necessari alcuni componenti.</span><span class="sxs-lookup"><span data-stu-id="49ccb-114">A few components are required to build a hybrid connectivity deployment.</span></span> <span data-ttu-id="49ccb-115">La preparazione di alcuni di questi richiede tempo ed è quindi necessario pianificare di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="49ccb-115">Some of these components take time to prepare, so plan accordingly.</span></span>

### <a name="azure"></a><span data-ttu-id="49ccb-116">Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-116">Azure</span></span>

- <span data-ttu-id="49ccb-117">Se non si ha una sottoscrizione di Azure, creare un [account gratuito](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) prima di iniziare.</span><span class="sxs-lookup"><span data-stu-id="49ccb-117">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) before you begin.</span></span>
- <span data-ttu-id="49ccb-118">Creare un'[app Web](/vsts/build-release/apps/cd/azure/aspnet-core-to-azure-webapp?tabs=vsts&view=vsts) in Azure.</span><span class="sxs-lookup"><span data-stu-id="49ccb-118">Create a [web app](/vsts/build-release/apps/cd/azure/aspnet-core-to-azure-webapp?tabs=vsts&view=vsts) in Azure.</span></span> <span data-ttu-id="49ccb-119">Prendere nota dell'URL dell'app Web perché sarà necessaria nella soluzione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-119">Make note of the web app URL because you'll need it in the solution.</span></span>

### <a name="azure-stack-hub"></a><span data-ttu-id="49ccb-120">Hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-120">Azure Stack Hub</span></span>

<span data-ttu-id="49ccb-121">Un partner OEM/hardware di Azure può distribuire un hub di Azure Stack di produzione e tutti gli utenti possono distribuire un Azure Stack Development Kit (ASDK).</span><span class="sxs-lookup"><span data-stu-id="49ccb-121">An Azure OEM/hardware partner can deploy a production Azure Stack Hub, and all users can deploy an Azure Stack Development Kit (ASDK).</span></span>

- <span data-ttu-id="49ccb-122">Usare l'hub di Azure Stack di produzione o distribuire l'ASDK.</span><span class="sxs-lookup"><span data-stu-id="49ccb-122">Use your production Azure Stack Hub or deploy the ASDK.</span></span>
   >[!Note]
   ><span data-ttu-id="49ccb-123">La distribuzione dell'ASDK può richiedere fino a 7 ore. È quindi necessario pianificare di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="49ccb-123">Deploying the ASDK can take up to 7 hours, so plan accordingly.</span></span>

- <span data-ttu-id="49ccb-124">Distribuire i servizi PaaS del [servizio app](/azure-stack/operator/azure-stack-app-service-deploy.md) nell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-124">Deploy [App Service](/azure-stack/operator/azure-stack-app-service-deploy.md) PaaS services to Azure Stack Hub.</span></span>
- <span data-ttu-id="49ccb-125">[Creare piani e offerte](/azure-stack/operator/service-plan-offer-subscription-overview.md) nell'ambiente dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-125">[Create plans and offers](/azure-stack/operator/service-plan-offer-subscription-overview.md) in the Azure Stack Hub environment.</span></span>
- <span data-ttu-id="49ccb-126">[Creare una sottoscrizione tenant](/azure-stack/operator/azure-stack-subscribe-plan-provision-vm.md) all'interno dell'ambiente dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-126">[Create tenant subscription](/azure-stack/operator/azure-stack-subscribe-plan-provision-vm.md) within the Azure Stack Hub environment.</span></span>

### <a name="azure-stack-hub-components"></a><span data-ttu-id="49ccb-127">Componenti dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-127">Azure Stack Hub components</span></span>

<span data-ttu-id="49ccb-128">Un operatore dell'hub di Azure Stack deve distribuire il servizio app, creare piani e offerte, creare una sottoscrizione tenant e aggiungere l'immagine di Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="49ccb-128">An Azure Stack Hub operator must deploy the App Service, create plans and offers, create a tenant subscription, and add the Windows Server 2016 image.</span></span> <span data-ttu-id="49ccb-129">Se questi componenti sono già disponibili, prima di avviare questa soluzione assicurarsi che soddisfino i requisiti.</span><span class="sxs-lookup"><span data-stu-id="49ccb-129">If you already have these components, make sure they meet the requirements before you start this  solution.</span></span>

<span data-ttu-id="49ccb-130">Questa soluzione di esempio presuppone che l'utente abbia una certa conoscenza di base di Azure e dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-130">This solution example assumes that you have some basic knowledge of Azure and Azure Stack Hub.</span></span> <span data-ttu-id="49ccb-131">Per altre informazioni prima di avviare la soluzione, vedere gli articoli seguenti:</span><span class="sxs-lookup"><span data-stu-id="49ccb-131">To learn more before starting the solution, read the following articles:</span></span>

- [<span data-ttu-id="49ccb-132">Introduzione ad Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-132">Introduction to Azure</span></span>](https://azure.microsoft.com/overview/what-is-azure/)
- [<span data-ttu-id="49ccb-133">Concetti chiave dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-133">Azure Stack Hub Key Concepts</span></span>](/azure-stack/operator/azure-stack-overview.md)

### <a name="before-you-begin"></a><span data-ttu-id="49ccb-134">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="49ccb-134">Before you begin</span></span>

<span data-ttu-id="49ccb-135">Prima di iniziare la configurazione della connettività di cloud ibrido, verificare che siano soddisfatti i criteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="49ccb-135">Verify that you meet the following criteria before you start configuring hybrid cloud connectivity:</span></span>

- <span data-ttu-id="49ccb-136">Disponibilità di un indirizzo IPv4 pubblico esterno per il dispositivo VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-136">You need an externally facing public IPv4 address for your VPN device.</span></span> <span data-ttu-id="49ccb-137">Questo indirizzo IP non può trovarsi dietro un dispositivo NAT (Network Address Translation).</span><span class="sxs-lookup"><span data-stu-id="49ccb-137">This IP address can't be located behind a NAT (Network Address Translation).</span></span>
- <span data-ttu-id="49ccb-138">Distribuzione di tutte le risorse nella stessa area/posizione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-138">All resources are deployed in the same region/location.</span></span>

#### <a name="solution-example-values"></a><span data-ttu-id="49ccb-139">Valori degli esempi della soluzione</span><span class="sxs-lookup"><span data-stu-id="49ccb-139">Solution example values</span></span>

<span data-ttu-id="49ccb-140">Gli esempi in questa soluzione usano i valori seguenti.</span><span class="sxs-lookup"><span data-stu-id="49ccb-140">The examples in this solution use the following values.</span></span> <span data-ttu-id="49ccb-141">È possibile usare questi valori per creare un ambiente di test o farvi riferimento per comprendere meglio gli esempi.</span><span class="sxs-lookup"><span data-stu-id="49ccb-141">You can use these values to create a test environment or refer to them for a better understanding of the examples.</span></span> <span data-ttu-id="49ccb-142">Per altre informazioni sulle impostazioni di un gateway VPN, vedere [Informazioni sulle impostazioni del gateway VPN](/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings).</span><span class="sxs-lookup"><span data-stu-id="49ccb-142">For more information about VPN gateway settings, see [About VPN Gateway Settings](/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings).</span></span>

<span data-ttu-id="49ccb-143">Specifiche della connessione:</span><span class="sxs-lookup"><span data-stu-id="49ccb-143">Connection specifications:</span></span>

- <span data-ttu-id="49ccb-144">**Tipo VPN**: Basato su route</span><span class="sxs-lookup"><span data-stu-id="49ccb-144">**VPN type**: route-based</span></span>
- <span data-ttu-id="49ccb-145">**Tipo di connessione**: Da sito a sito (IPSec)</span><span class="sxs-lookup"><span data-stu-id="49ccb-145">**Connection type**: site-to-site (IPsec)</span></span>
- <span data-ttu-id="49ccb-146">**Tipo di gateway**: VPN</span><span class="sxs-lookup"><span data-stu-id="49ccb-146">**Gateway type**: VPN</span></span>
- <span data-ttu-id="49ccb-147">**Nome connessione di Azure**: Azure-Gateway-AzureStack-S2SGateway (il portale inserisce questo valore automaticamente)</span><span class="sxs-lookup"><span data-stu-id="49ccb-147">**Azure connection name**: Azure-Gateway-AzureStack-S2SGateway (the portal will autofill this value)</span></span>
- <span data-ttu-id="49ccb-148">**Nome connessione dell'hub di Azure Stack**: AzureStack-Gateway-Azure-S2SGateway (il portale inserisce questo valore automaticamente)</span><span class="sxs-lookup"><span data-stu-id="49ccb-148">**Azure Stack Hub connection name**: AzureStack-Gateway-Azure-S2SGateway (the portal will autofill this value)</span></span>
- <span data-ttu-id="49ccb-149">**Chiave condivisa**: qualsiasi valore compatibile con l'hardware VPN, con valori corrispondenti in entrambi i lati della connessione</span><span class="sxs-lookup"><span data-stu-id="49ccb-149">**Shared key**: any compatible with VPN hardware, with matching values on both sides of connection</span></span>
- <span data-ttu-id="49ccb-150">**Sottoscrizione**: qualsiasi sottoscrizione preferita</span><span class="sxs-lookup"><span data-stu-id="49ccb-150">**Subscription**: any preferred subscription</span></span>
- <span data-ttu-id="49ccb-151">**Gruppo di risorse**: Test-Infra</span><span class="sxs-lookup"><span data-stu-id="49ccb-151">**Resource group**: Test-Infra</span></span>

<span data-ttu-id="49ccb-152">Indirizzi IP di rete e subnet:</span><span class="sxs-lookup"><span data-stu-id="49ccb-152">Network and subnet IP addresses:</span></span>

| <span data-ttu-id="49ccb-153">Connessione di Azure/dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-153">Azure/Azure Stack Hub Connection</span></span> | <span data-ttu-id="49ccb-154">Nome</span><span class="sxs-lookup"><span data-stu-id="49ccb-154">Name</span></span> | <span data-ttu-id="49ccb-155">Subnet</span><span class="sxs-lookup"><span data-stu-id="49ccb-155">Subnet</span></span> | <span data-ttu-id="49ccb-156">Indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="49ccb-156">IP Address</span></span> |
|---|---|---|---|
| <span data-ttu-id="49ccb-157">Rete virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-157">Azure vNet</span></span> | <span data-ttu-id="49ccb-158">ApplicationvNet</span><span class="sxs-lookup"><span data-stu-id="49ccb-158">ApplicationvNet</span></span><br><span data-ttu-id="49ccb-159">10.100.102.9/23</span><span class="sxs-lookup"><span data-stu-id="49ccb-159">10.100.102.9/23</span></span> | <span data-ttu-id="49ccb-160">ApplicationSubnet</span><span class="sxs-lookup"><span data-stu-id="49ccb-160">ApplicationSubnet</span></span><br><span data-ttu-id="49ccb-161">10.100.102.0/24</span><span class="sxs-lookup"><span data-stu-id="49ccb-161">10.100.102.0/24</span></span> |  |
|  |  | <span data-ttu-id="49ccb-162">GatewaySubnet</span><span class="sxs-lookup"><span data-stu-id="49ccb-162">GatewaySubnet</span></span><br><span data-ttu-id="49ccb-163">10.100.103.0/24</span><span class="sxs-lookup"><span data-stu-id="49ccb-163">10.100.103.0/24</span></span> |  |
| <span data-ttu-id="49ccb-164">Rete virtuale dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-164">Azure Stack Hub vNet</span></span> | <span data-ttu-id="49ccb-165">ApplicationvNet</span><span class="sxs-lookup"><span data-stu-id="49ccb-165">ApplicationvNet</span></span><br><span data-ttu-id="49ccb-166">10.100.100.0/23</span><span class="sxs-lookup"><span data-stu-id="49ccb-166">10.100.100.0/23</span></span> | <span data-ttu-id="49ccb-167">ApplicationSubnet</span><span class="sxs-lookup"><span data-stu-id="49ccb-167">ApplicationSubnet</span></span> <br><span data-ttu-id="49ccb-168">10.100.100.0/24</span><span class="sxs-lookup"><span data-stu-id="49ccb-168">10.100.100.0/24</span></span> |  |
|  |  | <span data-ttu-id="49ccb-169">GatewaySubnet</span><span class="sxs-lookup"><span data-stu-id="49ccb-169">GatewaySubnet</span></span> <br><span data-ttu-id="49ccb-170">10.100101.0/24</span><span class="sxs-lookup"><span data-stu-id="49ccb-170">10.100101.0/24</span></span> |  |
| <span data-ttu-id="49ccb-171">Gateway di rete virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-171">Azure Virtual Network Gateway</span></span> | <span data-ttu-id="49ccb-172">Azure-Gateway</span><span class="sxs-lookup"><span data-stu-id="49ccb-172">Azure-Gateway</span></span> |  |  |
| <span data-ttu-id="49ccb-173">Gateway di rete virtuale dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-173">Azure Stack Hub Virtual Network Gateway</span></span> | <span data-ttu-id="49ccb-174">AzureStack-Gateway</span><span class="sxs-lookup"><span data-stu-id="49ccb-174">AzureStack-Gateway</span></span> |  |  |
| <span data-ttu-id="49ccb-175">IP pubblico di Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-175">Azure Public IP</span></span> | <span data-ttu-id="49ccb-176">Azure-GatewayPublicIP</span><span class="sxs-lookup"><span data-stu-id="49ccb-176">Azure-GatewayPublicIP</span></span> |  | <span data-ttu-id="49ccb-177">Determinato al momento della creazione</span><span class="sxs-lookup"><span data-stu-id="49ccb-177">Determined at creation</span></span> |
| <span data-ttu-id="49ccb-178">IP pubblico dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-178">Azure Stack Hub Public IP</span></span> | <span data-ttu-id="49ccb-179">AzureStack-GatewayPublicIP</span><span class="sxs-lookup"><span data-stu-id="49ccb-179">AzureStack-GatewayPublicIP</span></span> |  | <span data-ttu-id="49ccb-180">Determinato al momento della creazione</span><span class="sxs-lookup"><span data-stu-id="49ccb-180">Determined at creation</span></span> |
| <span data-ttu-id="49ccb-181">Gateway di rete locale di Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-181">Azure Local Network Gateway</span></span> | <span data-ttu-id="49ccb-182">AzureStack-S2SGateway</span><span class="sxs-lookup"><span data-stu-id="49ccb-182">AzureStack-S2SGateway</span></span><br>   <span data-ttu-id="49ccb-183">10.100.100.0/23</span><span class="sxs-lookup"><span data-stu-id="49ccb-183">10.100.100.0/23</span></span> |  | <span data-ttu-id="49ccb-184">Valore dell'IP pubblico dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-184">Azure Stack Hub Public IP Value</span></span> |
| <span data-ttu-id="49ccb-185">Gateway di rete locale dell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-185">Azure Stack Hub Local Network Gateway</span></span> | <span data-ttu-id="49ccb-186">Azure-S2SGateway</span><span class="sxs-lookup"><span data-stu-id="49ccb-186">Azure-S2SGateway</span></span><br><span data-ttu-id="49ccb-187">10.100.102.0/23</span><span class="sxs-lookup"><span data-stu-id="49ccb-187">10.100.102.0/23</span></span> |  | <span data-ttu-id="49ccb-188">Valore dell'IP pubblico di Azure</span><span class="sxs-lookup"><span data-stu-id="49ccb-188">Azure Public IP Value</span></span> |

## <a name="create-a-virtual-network-in-global-azure-and-azure-stack-hub"></a><span data-ttu-id="49ccb-189">Creare una rete virtuale in Azure globale e nell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-189">Create a virtual network in global Azure and Azure Stack Hub</span></span>

<span data-ttu-id="49ccb-190">Usare la procedura seguente per creare una rete virtuale tramite il portale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-190">Use the following steps to create a virtual network by using the portal.</span></span> <span data-ttu-id="49ccb-191">È possibile usare questi [valori di esempio](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal#values) se si usa questo articolo come soluzione singola.</span><span class="sxs-lookup"><span data-stu-id="49ccb-191">You can use these [example values](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal#values) if you're using this article as only a  solution.</span></span> <span data-ttu-id="49ccb-192">Se si usa questo articolo per configurare un ambiente di produzione, sostituire le impostazioni di esempio con i propri valori.</span><span class="sxs-lookup"><span data-stu-id="49ccb-192">If you're using this article to configure a production environment, replace the example settings with  your own values.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="49ccb-193">È necessario assicurarsi che non si verifichi una sovrapposizione di indirizzi IP negli spazi indirizzi della rete virtuale di Azure o dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-193">You must ensure that there isn't an overlap of IP addresses in Azure or Azure Stack Hub vNet address spaces.</span></span>

<span data-ttu-id="49ccb-194">Per creare una rete virtuale in Azure:</span><span class="sxs-lookup"><span data-stu-id="49ccb-194">To create a vNet in Azure:</span></span>

1. <span data-ttu-id="49ccb-195">Tramite il browser connettersi al [portale di Azure](https://portal.azure.com/) e accedere con l'account Azure.</span><span class="sxs-lookup"><span data-stu-id="49ccb-195">Use your browser to connect to the [Azure portal](https://portal.azure.com/) and sign in with your Azure account.</span></span>
2. <span data-ttu-id="49ccb-196">Selezionare **Crea una risorsa**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-196">Select **Create a resource**.</span></span> <span data-ttu-id="49ccb-197">Nel campo **Cerca nel Marketplace** immettere 'rete virtuale'.</span><span class="sxs-lookup"><span data-stu-id="49ccb-197">In the **Search the marketplace** field, enter 'virtual network'.</span></span> <span data-ttu-id="49ccb-198">Selezionare **Rete virtuale** nei risultati.</span><span class="sxs-lookup"><span data-stu-id="49ccb-198">Select **Virtual network** from the results.</span></span>
3. <span data-ttu-id="49ccb-199">Nell'elenco **Selezionare un modello di distribuzione** selezionare **Resource Manager** e quindi selezionare **Crea**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-199">From the **Select a deployment model** list, select **Resource Manager**, and then select **Create**.</span></span>
4. <span data-ttu-id="49ccb-200">In **Crea rete virtuale** configurare le impostazioni della rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-200">On **Create virtual network**, configure the VNet settings.</span></span> <span data-ttu-id="49ccb-201">I nomi dei campi obbligatori sono preceduti da un asterisco rosso.</span><span class="sxs-lookup"><span data-stu-id="49ccb-201">The required fields names are prefixed with a red asterisk.</span></span>  <span data-ttu-id="49ccb-202">Quando si immette un valore valido, l'asterisco diventa un segno di spunta verde.</span><span class="sxs-lookup"><span data-stu-id="49ccb-202">When you enter a valid value, the asterisk changes to a green check mark.</span></span>

<span data-ttu-id="49ccb-203">Per creare una rete virtuale nell'hub di Azure Stack:</span><span class="sxs-lookup"><span data-stu-id="49ccb-203">To create a vNet in Azure Stack Hub:</span></span>

1. <span data-ttu-id="49ccb-204">Ripetere i passaggi precedenti (1-4) usando il **portale del tenant** dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-204">Repeat the steps above (1-4) using the Azure Stack Hub **tenant portal**.</span></span>

## <a name="add-a-gateway-subnet"></a><span data-ttu-id="49ccb-205">Aggiungere una subnet del gateway</span><span class="sxs-lookup"><span data-stu-id="49ccb-205">Add a gateway subnet</span></span>

<span data-ttu-id="49ccb-206">Prima di connettere la rete virtuale a un gateway, è necessario creare la subnet del gateway per la rete virtuale con cui si vuole stabilire la connessione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-206">Before connecting your virtual network to a gateway, you need to create the gateway subnet for the virtual network that you want to connect to.</span></span> <span data-ttu-id="49ccb-207">I servizi del gateway usano gli indirizzi IP specificati nella subnet del gateway.</span><span class="sxs-lookup"><span data-stu-id="49ccb-207">The gateway services use the IP addresses you specify in the gateway subnet.</span></span>

<span data-ttu-id="49ccb-208">Nel [portale di Azure](https://portal.azure.com/) passare alla rete virtuale di Resource Manager in cui si vuole creare un gateway di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-208">In the [Azure portal](https://portal.azure.com/), navigate to the Resource Manager virtual network where you want to create a virtual network gateway.</span></span>

1. <span data-ttu-id="49ccb-209">Selezionare la rete virtuale per aprire la pagina **Rete virtuale**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-209">Select the vNet to open the **Virtual network** page.</span></span>
2. <span data-ttu-id="49ccb-210">In **IMPOSTAZIONI** selezionare **Subnet**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-210">In **SETTINGS**, select **Subnets**.</span></span>
3. <span data-ttu-id="49ccb-211">Nella pagina **Subnet** selezionare **+ Subnet del gateway** per aprire la pagina **Aggiungi subnet**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-211">On the **Subnets** page, select **+Gateway subnet** to open the **Add subnet** page.</span></span>

    ![Aggiungere la subnet del gateway](media/solution-deployment-guide-connectivity/image4.png)

4. <span data-ttu-id="49ccb-213">Il **nome** della subnet viene compilato automaticamente con il valore 'GatewaySubnet'.</span><span class="sxs-lookup"><span data-stu-id="49ccb-213">The **Name** for the subnet is automatically filled in with the value 'GatewaySubnet'.</span></span> <span data-ttu-id="49ccb-214">Questo valore è obbligatorio per consentire ad Azure di riconoscere la subnet come subnet del gateway.</span><span class="sxs-lookup"><span data-stu-id="49ccb-214">This value is required for Azure to recognize the subnet as the gateway subnet.</span></span>
5. <span data-ttu-id="49ccb-215">Modificare i valori di **Intervallo indirizzi**  specificati in modo che corrispondano ai requisiti di configurazione e quindi selezionare **OK**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-215">Change the **Address range** values that are provided to match your configuration requirements and then select **OK**.</span></span>

## <a name="create-a-virtual-network-gateway-in-azure-and-azure-stack"></a><span data-ttu-id="49ccb-216">Creare un gateway di rete virtuale in Azure e nell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-216">Create a Virtual Network Gateway in Azure and Azure Stack</span></span>

<span data-ttu-id="49ccb-217">Usare la procedura seguente per creare un gateway di rete virtuale in Azure.</span><span class="sxs-lookup"><span data-stu-id="49ccb-217">Use the following steps to create a virtual network gateway in Azure.</span></span>

1. <span data-ttu-id="49ccb-218">Nel lato sinistro della pagina del portale selezionare **+** e immettere 'gateway di rete virtuale' nel campo di ricerca.</span><span class="sxs-lookup"><span data-stu-id="49ccb-218">On the left side of the portal page, select **+** and enter 'virtual network gateway' in the search field.</span></span>
2. <span data-ttu-id="49ccb-219">In **Risultati** selezionare **Gateway di rete virtuale**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-219">In **Results**, select **Virtual network gateway**.</span></span>
3. <span data-ttu-id="49ccb-220">In **Gateway di rete virtuale** selezionare **Crea** per aprire la pagina **Crea gateway di rete virtuale**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-220">In **Virtual network gateway**, select **Create** to open the **Create virtual network gateway** page.</span></span>
4. <span data-ttu-id="49ccb-221">In **Crea gateway di rete virtuale** specificare i valori per il gateway di rete virtuale usando i **valori di esempio dell'esercitazione**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-221">On **Create virtual network gateway**, specify the values for your network gateway using our **Tutorial example values**.</span></span> <span data-ttu-id="49ccb-222">Includere i valori aggiuntivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="49ccb-222">Include the following additional values:</span></span>

   - <span data-ttu-id="49ccb-223">**SKU**: Basic</span><span class="sxs-lookup"><span data-stu-id="49ccb-223">**SKU**: basic</span></span>
   - <span data-ttu-id="49ccb-224">**Rete virtuale**: selezionare la rete virtuale creata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="49ccb-224">**Virtual Network**: Select the virtual network you created earlier.</span></span> <span data-ttu-id="49ccb-225">La subnet del gateway creata viene selezionata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="49ccb-225">The gateway subnet you created is automatically selected.</span></span>
   - <span data-ttu-id="49ccb-226">**Prima configurazione IP**:  IP pubblico del gateway.</span><span class="sxs-lookup"><span data-stu-id="49ccb-226">**First IP Configuration**:  The public IP of your gateway.</span></span>
     - <span data-ttu-id="49ccb-227">Selezionare **Crea configurazione IP gateway**. Si passerà alla pagina **Scegli indirizzo IP pubblico**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-227">Select **Create gateway IP configuration**, which takes you to the **Choose public IP address** page.</span></span>
     - <span data-ttu-id="49ccb-228">Selezionare **+ Crea nuovo** per aprire la pagina **Crea indirizzo IP pubblico**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-228">Select **+Create new** to open the **Create public IP address** page.</span></span>
     - <span data-ttu-id="49ccb-229">Immettere un **nome** per l'indirizzo IP pubblico.</span><span class="sxs-lookup"><span data-stu-id="49ccb-229">Enter a **Name** for your public IP address.</span></span> <span data-ttu-id="49ccb-230">Mantenere lo SKU **Basic** e quindi selezionare **OK** per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="49ccb-230">Leave the SKU as **Basic**, and then select **OK** to save your changes.</span></span>

       > [!Note]
       > <span data-ttu-id="49ccb-231">Gateway VPN supporta attualmente solo l'allocazione degli indirizzi IP pubblici dinamici.</span><span class="sxs-lookup"><span data-stu-id="49ccb-231">Currently, VPN Gateway only supports Dynamic Public IP address allocation.</span></span> <span data-ttu-id="49ccb-232">Questo tuttavia non significa che l'indirizzo IP cambi dopo l'assegnazione al gateway VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-232">However, this doesn't mean that the IP address changes after it's assigned to your VPN gateway.</span></span> <span data-ttu-id="49ccb-233">L'unica volta in cui l'indirizzo IP pubblico viene modificato è quando il gateway viene eliminato e creato di nuovo.</span><span class="sxs-lookup"><span data-stu-id="49ccb-233">The only time the public IP address changes is when the gateway is deleted and re-created.</span></span> <span data-ttu-id="49ccb-234">In caso di ridimensionamento, reimpostazione o altre operazioni di manutenzione o aggiornamento del gateway VPN, l'indirizzo IP non cambia.</span><span class="sxs-lookup"><span data-stu-id="49ccb-234">Resizing, resetting, or other internal maintenance/upgrades to your VPN gateway don't change the IP address.</span></span>

5. <span data-ttu-id="49ccb-235">Verificare le impostazioni del gateway.</span><span class="sxs-lookup"><span data-stu-id="49ccb-235">Verify your gateway settings.</span></span>
6. <span data-ttu-id="49ccb-236">Selezionare **Crea** per creare il gateway VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-236">Select **Create** to create the VPN gateway.</span></span> <span data-ttu-id="49ccb-237">Le impostazioni del gateway vengono convalidate e nel dashboard viene visualizzato il riquadro "Distribuzione di Gateway di rete virtuale".</span><span class="sxs-lookup"><span data-stu-id="49ccb-237">The gateway settings are validated and the "Deploying Virtual network gateway" tile is shown on your dashboard.</span></span>

   >[!Note]
   ><span data-ttu-id="49ccb-238">La creazione di un gateway può richiedere fino a 45 minuti.</span><span class="sxs-lookup"><span data-stu-id="49ccb-238">Creating a gateway can take up to 45 minutes.</span></span> <span data-ttu-id="49ccb-239">Potrebbe essere necessario aggiornare la pagina del portale per visualizzare lo stato di completamento.</span><span class="sxs-lookup"><span data-stu-id="49ccb-239">You may need to refresh your portal page to see the completed status.</span></span>

    <span data-ttu-id="49ccb-240">Dopo la creazione del gateway, è possibile visualizzare l'indirizzo IP assegnato a questo esaminando la rete virtuale nel portale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-240">After the gateway is created, you can see the IP address assigned to it by looking at the virtual network in the portal.</span></span> <span data-ttu-id="49ccb-241">Il gateway viene visualizzato come un dispositivo connesso.</span><span class="sxs-lookup"><span data-stu-id="49ccb-241">The gateway appears as a connected device.</span></span> <span data-ttu-id="49ccb-242">Per altre informazioni sul gateway, selezionare il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="49ccb-242">To see more information about the gateway, select the device.</span></span>

7. <span data-ttu-id="49ccb-243">Ripetere i passaggi precedenti (1-5) nella distribuzione dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-243">Repeat the previous steps (1-5) on your Azure Stack Hub deployment.</span></span>

## <a name="create-the-local-network-gateway-in-azure-and-azure-stack-hub"></a><span data-ttu-id="49ccb-244">Creare il gateway di rete locale in Azure e nell'hub di Azure Stack</span><span class="sxs-lookup"><span data-stu-id="49ccb-244">Create the local network gateway in Azure and Azure Stack Hub</span></span>

<span data-ttu-id="49ccb-245">Il gateway di rete locale in genere fa riferimento al percorso locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-245">The local network gateway typically refers to your on-premises location.</span></span> <span data-ttu-id="49ccb-246">Assegnare al sito un nome a cui Azure o l'hub di Azure Stack possa fare riferimento e quindi specificare:</span><span class="sxs-lookup"><span data-stu-id="49ccb-246">You give the site a name that Azure or Azure Stack Hub can refer to, and then specify:</span></span>

- <span data-ttu-id="49ccb-247">L'indirizzo IP del dispositivo VPN locale per cui si sta creando una connessione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-247">The IP address of the on-premises VPN device that you're creating a connection for.</span></span>
- <span data-ttu-id="49ccb-248">I prefissi degli indirizzi IP che verranno instradati tramite il gateway VPN al dispositivo VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-248">The IP address prefixes that will be routed through the VPN gateway to the VPN device.</span></span> <span data-ttu-id="49ccb-249">I prefissi degli indirizzi specificati sono quelli disponibili nella rete locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-249">The address prefixes you specify are the prefixes located on your on-premises network.</span></span>

  >[!Note]
  ><span data-ttu-id="49ccb-250">Se la rete locale cambia o è necessario modificare l'indirizzo IP pubblico del dispositivo VPN, è possibile aggiornare questi valori in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="49ccb-250">If your on-premises network changes or you need to change the public IP address for the VPN device, you can update these values later.</span></span>

1. <span data-ttu-id="49ccb-251">Nel portale selezionare **+ Crea una risorsa**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-251">In the portal, select **+Create a resource**.</span></span>
2. <span data-ttu-id="49ccb-252">Nella casella di ricerca immettere **Gateway di rete locale** e quindi selezionare **Invio** per eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="49ccb-252">In the search box, enter **Local network gateway**, then select **Enter** to search.</span></span> <span data-ttu-id="49ccb-253">Verrà visualizzato un elenco di risultati.</span><span class="sxs-lookup"><span data-stu-id="49ccb-253">A list of results will display.</span></span>
3. <span data-ttu-id="49ccb-254">Selezionare **Gateway di rete locale** e quindi selezionare **Crea** per aprire la pagina **Crea un gateway di rete locale**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-254">Select **Local network gateway**, then select **Create** to open the **Create local network gateway** page.</span></span>
4. <span data-ttu-id="49ccb-255">In **Crea un gateway di rete locale** specificare i valori per il gateway di rete locale usando i **valori di esempio dell'esercitazione**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-255">On **Create local network gateway**, specify the values for your local network gateway using our **Tutorial example values**.</span></span> <span data-ttu-id="49ccb-256">Includere i valori aggiuntivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="49ccb-256">Include the following additional values:</span></span>

    - <span data-ttu-id="49ccb-257">**Indirizzo IP**: l'indirizzo IP pubblico del dispositivo VPN a cui si vuole connettere Azure o l'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-257">**IP address**: The public IP address of the VPN device that you want Azure or Azure Stack Hub to connect to.</span></span> <span data-ttu-id="49ccb-258">Specificare un indirizzo IP pubblico valido che non si trovi dietro un dispositivo NAT, in modo che Azure possa raggiungere l'indirizzo.</span><span class="sxs-lookup"><span data-stu-id="49ccb-258">Specify a valid public IP address that isn't behind a NAT so Azure can reach the address.</span></span> <span data-ttu-id="49ccb-259">Se non si ha ancora a disposizione l'indirizzo IP, è possibile usare un valore dell'esempio come segnaposto.</span><span class="sxs-lookup"><span data-stu-id="49ccb-259">If you don't have the IP address right now, you can use a value from the example as a placeholder.</span></span> <span data-ttu-id="49ccb-260">Sarà necessario tornare indietro e sostituire il segnaposto con l'indirizzo IP pubblico del dispositivo VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-260">You'll have to go back and replace the placeholder with the public IP address of your VPN device.</span></span> <span data-ttu-id="49ccb-261">Azure sarà in grado di connettersi al dispositivo solo quando verrà specificato un indirizzo valido.</span><span class="sxs-lookup"><span data-stu-id="49ccb-261">Azure can't connect to the device until you provide a valid address.</span></span>
    - <span data-ttu-id="49ccb-262">**Spazio di indirizzi**: intervallo di indirizzi per la rete rappresentata da questa rete locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-262">**Address Space**: the address range for the network that this local network represents.</span></span> <span data-ttu-id="49ccb-263">È possibile aggiungere più intervalli di spazi indirizzi.</span><span class="sxs-lookup"><span data-stu-id="49ccb-263">You can add multiple address space ranges.</span></span> <span data-ttu-id="49ccb-264">Assicurarsi che gli intervalli specificati non si sovrappongano con gli intervalli di altre reti a cui ci si vuole connettere.</span><span class="sxs-lookup"><span data-stu-id="49ccb-264">Make sure that the ranges you specify don't overlap with ranges of other networks that you want to connect to.</span></span> <span data-ttu-id="49ccb-265">Azure indirizzerà l'intervallo di indirizzi specificato all'indirizzo IP del dispositivo VPN locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-265">Azure will route the address range that you specify to the on-premises VPN device IP address.</span></span> <span data-ttu-id="49ccb-266">Usare valori personalizzati, non un valore di esempio, se ci si vuole connettere al sito locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-266">Use your own values if you want to connect to your on-premises site, not an example value.</span></span>
    - <span data-ttu-id="49ccb-267">**Configura le impostazioni BGP:** usare solo quando si configura BGP.</span><span class="sxs-lookup"><span data-stu-id="49ccb-267">**Configure BGP settings**: Use only when configuring BGP.</span></span> <span data-ttu-id="49ccb-268">In caso contrario, non selezionare questa opzione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-268">Otherwise, don't select this option.</span></span>
    - <span data-ttu-id="49ccb-269">**Sottoscrizione** verificare che sia visualizzata la sottoscrizione corretta.</span><span class="sxs-lookup"><span data-stu-id="49ccb-269">**Subscription**: Verify that the correct subscription is showing.</span></span>
    - <span data-ttu-id="49ccb-270">**Gruppo di risorse**: selezionare il gruppo di risorse che si vuole usare.</span><span class="sxs-lookup"><span data-stu-id="49ccb-270">**Resource Group**: Select the resource group that you want to use.</span></span> <span data-ttu-id="49ccb-271">È possibile creare un nuovo gruppo di risorse o selezionarne uno già creato.</span><span class="sxs-lookup"><span data-stu-id="49ccb-271">You can either create a new resource group or select one that you've already created.</span></span>
    - <span data-ttu-id="49ccb-272">**Località**: selezionare la località in cui verrà creato questo oggetto.</span><span class="sxs-lookup"><span data-stu-id="49ccb-272">**Location**: Select the location that this object will be created in.</span></span> <span data-ttu-id="49ccb-273">È possibile, ma non necessario, selezionare la stessa località in cui risiede la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-273">You may want to select the same location that your VNet resides in, but you're not required to do so.</span></span>
5. <span data-ttu-id="49ccb-274">Dopo aver specificato i valori obbligatori, selezionare **Crea** per creare il gateway di rete locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-274">When you finish specifying the required values, select **Create** to create the local network gateway.</span></span>
6. <span data-ttu-id="49ccb-275">Ripetere questi passaggi (1-5) nella distribuzione dell'hub di Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="49ccb-275">Repeat these steps (1-5) on your Azure Stack Hub deployment.</span></span>

## <a name="configure-your-connection"></a><span data-ttu-id="49ccb-276">Configurare la connessione</span><span class="sxs-lookup"><span data-stu-id="49ccb-276">Configure your connection</span></span>

<span data-ttu-id="49ccb-277">Le connessioni da sito a sito verso una rete locale richiedono un dispositivo VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-277">Site-to-site connections to an on-premises network require a VPN device.</span></span> <span data-ttu-id="49ccb-278">Il dispositivo VPN configurato viene detto connessione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-278">The VPN device you configure is referred to as a connection.</span></span> <span data-ttu-id="49ccb-279">Per configurare la connessione, sono necessari:</span><span class="sxs-lookup"><span data-stu-id="49ccb-279">To configure your connection, you need:</span></span>

- <span data-ttu-id="49ccb-280">Chiave condivisa.</span><span class="sxs-lookup"><span data-stu-id="49ccb-280">A shared key.</span></span> <span data-ttu-id="49ccb-281">Si tratta della stessa chiave condivisa specificata durante la creazione della connessione VPN da sito a sito.</span><span class="sxs-lookup"><span data-stu-id="49ccb-281">This key is the same shared key that you specify when creating your site-to-site VPN connection.</span></span> <span data-ttu-id="49ccb-282">In questi esempi viene usata una chiave condivisa semplice.</span><span class="sxs-lookup"><span data-stu-id="49ccb-282">In our examples, we use a basic shared key.</span></span> <span data-ttu-id="49ccb-283">È consigliabile generare una chiave più complessa per l'uso effettivo.</span><span class="sxs-lookup"><span data-stu-id="49ccb-283">We recommend that you generate a more complex key to use.</span></span>
- <span data-ttu-id="49ccb-284">Indirizzo IP pubblico del gateway di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-284">The public IP address of your virtual network gateway.</span></span> <span data-ttu-id="49ccb-285">È possibile visualizzare l'indirizzo IP pubblico usando il portale di Azure, PowerShell o l'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="49ccb-285">You can view the public IP address by using the Azure portal, PowerShell, or CLI.</span></span> <span data-ttu-id="49ccb-286">Per trovare l'indirizzo IP pubblico del gateway VPN usando il portale di Azure, passare a Gateway di rete virtuale e quindi selezionare il nome del gateway.</span><span class="sxs-lookup"><span data-stu-id="49ccb-286">To find the public IP address of your VPN gateway using the Azure portal, go to virtual network gateways, then select the name of your gateway.</span></span>

<span data-ttu-id="49ccb-287">Usare la procedura seguente per creare una connessione VPN da sito a sito tra il gateway di rete virtuale e il dispositivo VPN locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-287">Use the following steps to create a site-to-site VPN connection between your virtual network gateway and your on-premises VPN device.</span></span>

1. <span data-ttu-id="49ccb-288">Nel portale di Azure selezionare **+ Crea una risorsa**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-288">In the Azure portal, select **+Create a resource**.</span></span>
2. <span data-ttu-id="49ccb-289">Cercare **connessioni**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-289">Search for **connections**.</span></span>
3. <span data-ttu-id="49ccb-290">In **Risultati**  selezionare **Connessioni**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-290">In **Results**, select **Connections**.</span></span>
4. <span data-ttu-id="49ccb-291">In **Connessione** selezionare **Crea**.</span><span class="sxs-lookup"><span data-stu-id="49ccb-291">On **Connection**, select **Create**.</span></span>
5. <span data-ttu-id="49ccb-292">In **Crea connessione** configurare le impostazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="49ccb-292">On **Create Connection**, configure the following settings:</span></span>

    - <span data-ttu-id="49ccb-293">**Tipo di connessione**: selezionare Da sito a sito (IPSec).</span><span class="sxs-lookup"><span data-stu-id="49ccb-293">**Connection type**: Select site-to-site (IPSec).</span></span>
    - <span data-ttu-id="49ccb-294">**Gruppo di risorse**: selezionare il gruppo di risorse di test.</span><span class="sxs-lookup"><span data-stu-id="49ccb-294">**Resource Group**: Select your test resource group.</span></span>
    - <span data-ttu-id="49ccb-295">**Gateway di rete virtuale**: selezionare il gateway di rete virtuale creato.</span><span class="sxs-lookup"><span data-stu-id="49ccb-295">**Virtual Network Gateway**: Select the virtual network gateway you created.</span></span>
    - <span data-ttu-id="49ccb-296">**Gateway di rete locale**: selezionare il gateway di rete locale creato.</span><span class="sxs-lookup"><span data-stu-id="49ccb-296">**Local Network Gateway**: Select the local network gateway you created.</span></span>
    - <span data-ttu-id="49ccb-297">**Nome connessione**: questo nome viene popolato automaticamente con i valori dei due gateway.</span><span class="sxs-lookup"><span data-stu-id="49ccb-297">**Connection Name**: This name is autopopulated using the values from the two gateways.</span></span>
    - <span data-ttu-id="49ccb-298">**Chiave condivisa**: questo valore deve corrispondere a quello usato per il dispositivo VPN locale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-298">**Shared Key**: This value must match the value that you're using for your local on-premises VPN device.</span></span> <span data-ttu-id="49ccb-299">L'esempio dell'esercitazione usa 'abc123', ma è consigliabile usare un valore più complesso.</span><span class="sxs-lookup"><span data-stu-id="49ccb-299">The tutorial example uses 'abc123', but you should use something more complex.</span></span> <span data-ttu-id="49ccb-300">L'aspetto importante è che questo valore *deve* corrispondere al valore specificato durante la configurazione del dispositivo VPN.</span><span class="sxs-lookup"><span data-stu-id="49ccb-300">The important thing is that this value *must* be the same value that you specify when configuring your VPN device.</span></span>
    - <span data-ttu-id="49ccb-301">I valori di **Sottoscrizione**, **Gruppo di risorse** e **Località** sono fissi.</span><span class="sxs-lookup"><span data-stu-id="49ccb-301">The values for **Subscription**, **Resource Group**, and **Location** are fixed.</span></span>

6. <span data-ttu-id="49ccb-302">Selezionare **OK** per creare la connessione.</span><span class="sxs-lookup"><span data-stu-id="49ccb-302">Select **OK** to create your connection.</span></span>

<span data-ttu-id="49ccb-303">È possibile visualizzare la connessione nella pagina **Connessioni** relativa al gateway di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="49ccb-303">You can see the connection in the **Connections** page of the virtual network gateway.</span></span> <span data-ttu-id="49ccb-304">Lo stato passa da *Sconosciuto* a *Connessione* e quindi a *Operazione completata*.</span><span class="sxs-lookup"><span data-stu-id="49ccb-304">The status will go from *Unknown* to *Connecting*, and then to *Succeeded*.</span></span>

## <a name="next-steps"></a><span data-ttu-id="49ccb-305">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="49ccb-305">Next steps</span></span>

- <span data-ttu-id="49ccb-306">Per altre informazioni sui modelli cloud di Azure, vedere [Modelli di progettazione cloud](/azure/architecture/patterns).</span><span class="sxs-lookup"><span data-stu-id="49ccb-306">To learn more about Azure Cloud Patterns, see [Cloud Design Patterns](/azure/architecture/patterns).</span></span>
